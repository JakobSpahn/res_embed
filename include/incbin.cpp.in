// Embed content into hex array for in-memory caching

#include <cstring>
#include <map>
#include <memory>
#include <string>
#include <vector>

#include "incbin.h"

#define STR(val) #val

using namespace std;

extern "C" const char hex_content_@FILE_NAME_HASH@[];
extern "C" const int hex_size_@FILE_NAME_HASH@;

class AddFile_@FILE_NAME_HASH@
{
	const char* file_name;

public :

	AddFile_@FILE_NAME_HASH@() : file_name("@FILE_NAME@")
	{
		if (!incbin.get())
			incbin.reset(new map<string, pair<const char*, size_t> >());

		incbin->emplace(file_name, std::make_pair(
			(char*)hex_content_@FILE_NAME_HASH@, hex_size_@FILE_NAME_HASH@));

		if (!incbin_mime.get())
			incbin_mime.reset(new map<string, string>());
		
		incbin_mime->emplace(file_name, STR(@FILE_MIME@));
	};
};

static AddFile_@FILE_NAME_HASH@ addFile_@FILE_NAME_HASH@;

